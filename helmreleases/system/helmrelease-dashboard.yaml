apiVersion: helm.toolkit.fluxcd.io/v2
kind: HelmRelease
metadata:
  labels:
    cozystack.io/repository: system
    cozystack.io/system-app: "true"
  name: dashboard
  namespace: cozy-dashboard
spec:
  chart:
    spec:
      chart: cozy-dashboard
      reconcileStrategy: Revision
      sourceRef:
        kind: HelmRepository
        name: cozystack-system
        namespace: cozy-system
      version: '*'
  dependsOn:
  - name: keycloak-configure
    namespace: cozy-keycloak
  install:
    crds: CreateReplace
    remediation:
      retries: -1
  interval: 5m
  releaseName: dashboard
  upgrade:
    crds: CreateReplace
    remediation:
      retries: -1
  values:
    kubeapps:
      authProxy:
        clientID: kubeapps
        clientSecret: [redacted
        cookieSecret: [redacted
        enabled: true
        extraFlags:
        - --ssl-insecure-skip-verify
        - --cookie-secure=false
        - --scope=openid email groups
        - --oidc-issuer-url=https://keycloak.moomboo.space/realms/cozy
        provider: oidc
    redis:
      master:
        podAnnotations:
          repository.cozystack.io/cozystack-apps: sha256:70b8b64d6ad6dd9596a7ecb5d70c2ed4e4e0deefd027ba5b630c3aa679bba039
          repository.cozystack.io/cozystack-extra: sha256:19be0d0f1f2464721803c53ebc64d82b7fec37c1ff074b7ba8f95f479e443c28
