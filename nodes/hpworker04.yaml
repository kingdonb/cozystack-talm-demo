# talm: nodes=["10.17.13.144"], endpoints=["10.17.13.144"], templates=["templates/controlplane.yaml"]
# THIS FILE IS AUTOGENERATED. DO NOT EDIT IT!
machine:
  type: controlplane
  kubelet:
    extraConfig:
      maxPods: 512
    nodeIP:
      validSubnets:
        - 10.17.13.0/24
  network:
    # -- Discovered interfaces:
    # enx1062e5192ca6:
    #   id: eno1
    #   hardwareAddr:10:62:e5:19:2c:a6
    #   busPath: 0000:00:1f.6
    #   driver: e1000e
    #   vendor: Intel Corporation
    #   product: Ethernet Connection (5) I219-LM)
    interfaces:
      - deviceSelector:
          busPath: 0000:00:1f.6
        addresses:
          - 10.17.13.144/24
        routes:
          - network: 0.0.0.0/0
            gateway: 10.17.13.249
        vip:
          ip: 10.17.13.253
    nameservers:
      - 10.17.13.254
  install:
    # -- Discovered disks:
    # /dev/loop0:
    #    model: 
    #    serial: 
    #    wwid: 
    #    size: 0.15 MB
    # /dev/loop1:
    #    model: 
    #    serial: 
    #    wwid: 
    #    size: 0.02 GB
    # /dev/loop10:
    #    model: 
    #    serial: 
    #    wwid: 
    #    size: 0.00 MB
    # /dev/loop11:
    #    model: 
    #    serial: 
    #    wwid: 
    #    size: 0.07 GB
    # /dev/loop2:
    #    model: 
    #    serial: 
    #    wwid: 
    #    size: 0.01 GB
    # /dev/loop3:
    #    model: 
    #    serial: 
    #    wwid: 
    #    size: 0.53 MB
    # /dev/loop4:
    #    model: 
    #    serial: 
    #    wwid: 
    #    size: 0.00 MB
    # /dev/loop5:
    #    model: 
    #    serial: 
    #    wwid: 
    #    size: 0.00 MB
    # /dev/loop6:
    #    model: 
    #    serial: 
    #    wwid: 
    #    size: 0.00 MB
    # /dev/loop7:
    #    model: 
    #    serial: 
    #    wwid: 
    #    size: 0.00 MB
    # /dev/loop8:
    #    model: 
    #    serial: 
    #    wwid: 
    #    size: 0.00 MB
    # /dev/loop9:
    #    model: 
    #    serial: 
    #    wwid: 
    #    size: 0.00 MB
    # /dev/nvme0n1:
    #    model: PM9B1 NVMe Samsung 256GB
    #    serial: S6N1NF0W714606
    #    wwid: nvme.144d-20202020202053364e314e463057373134363036-504d394231204e564d652053616d73756e67203235364742-00000001
    #    size: 0.23 TB
    disk: /dev/nvme0n1
    image: kingdonb/talos:v1.8.1-cozy-spin
    extraKernelArgs:
      - "kexec_load_disabled=1"
      - "sysctl.kernel.kexec_load_disabled=1"
      - "proc.sys.kernel.kexec_load_disabled=1"
  files:
    - content: "[plugins]\n  [plugins.\"io.containerd.grpc.v1.cri\"]\n    device_ownership_from_security_context = true      \n  [plugins.\"io.containerd.cri.v1.runtime\"]\n    device_ownership_from_security_context = true\n"
      permissions: 0o0
      path: /etc/cri/conf.d/20-customization.part
      op: create
  kernel:
    modules:
      - name: openvswitch
      - name: drbd
        parameters:
          - usermode_helper=disabled
      - name: zfs
      - name: spl
  registries:
    mirrors:
      docker.io:
        endpoints:
          - http://netmoom-13net.turkey.local:5050
      quay.io:
        endpoints:
          - http://netmoom-13net.turkey.local:5052
      gcr.io:
        endpoints:
          - http://netmoom-13net.turkey.local:5053
      ghcr.io:
        endpoints:
          - http://netmoom-13net.turkey.local:5054
      registry.k8s.io:
        endpoints:
          - http://netmoom-13net.turkey.local:5051
  sysctls:
    kernel.domainname: cozy.local
cluster:
  controlPlane:
    endpoint: https://10.17.13.253:6443
  clusterName: cozystack
  network:
    cni:
      name: none
    dnsDomain: cozy.local
    serviceSubnets:
      - 10.96.0.0/16
  apiServer:
    certSANs:
      - 127.0.0.1
  controllerManager:
    extraArgs:
      bind-address: 0.0.0.0
  proxy:
    disabled: true
  scheduler:
    extraArgs:
      bind-address: 0.0.0.0
  discovery:
    enabled: false
  etcd:
    advertisedSubnets:
      - 10.17.13.0/24
  allowSchedulingOnControlPlanes: true
